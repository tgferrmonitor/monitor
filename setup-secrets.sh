#!/bin/bash

# Script para configurar secrets do GitHub via CLI
# Baseado no arquivo .env do projeto

echo "üîß Configurando secrets do GitHub Actions..."
echo "üìç Reposit√≥rio: tgferrmonitor/monitor"
echo ""

# Verificar se gh CLI est√° instalado
if ! command -v gh &> /dev/null; then
    echo "‚ùå GitHub CLI n√£o encontrado!"
    echo "üí° Para instalar:"
    echo "   sudo apt install gh"
    echo "   ou"
    echo "   sudo snap install gh"
    exit 1
fi

# Verificar se est√° autenticado
if ! gh auth status &> /dev/null; then
    echo "‚ùå N√£o autenticado no GitHub!"
    echo "üí° Execute: gh auth login"
    exit 1
fi

echo "üîê Configurando secrets..."

# Roblox
echo "  üéÆ ROBLOSECURITY..."
gh secret set ROBLOSECURITY --body "_|WARNING:-DO-NOT-SHARE-THIS.--Sharing-this-will-allow-someone-to-log-in-as-you-and-to-steal-your-ROBUX-and-items.|_CAEaAhAB.5DD6CBFE82F72760A2CE09877D1CA767BC9A86307A283CA8AA3FB0F7BFC55576AE899DAF909E70B38CAFF1A395489614D78A45896F0CC03CC4E1D73837429E643ACCFAA68385EA02F5B14708633E892EA1677C9272160EECB0889F3B56CACF837DC11592E5E082C72EBF19717EB4ED0DC3AA9EEC751C7759FE807320A9DF978A625B90ACEC5A6A2A4B930D579E5173933E1B1DC64276C9FDBF373843A371F4BC799040B656A5E59C706F2EAF62062F13B7B0B1726384629E600F99CC7C5E45F174F2FDBA852C8D593B3F96075AD8F7AB3FC52C57BE079624D5EE3911BC62125132FB1C8DD263C4863A759AA1B71E204ACAAA11DBDF7C55C5CE8CFF2A62244FC3953A94EE1B1734F1984E4A9B66DB6C6100F01CD3ECA74B6F9638659C869AFE9BAB371A2FEC30A95F28EA8A344956583B1777970EBA239A578465E993031BEBB649392D148B6ED04B5E44302BFC33669350CFF9D616494D8DE1AD6517BA36118E1F19F0374CD6B6454FD7BA3B6247E897E4A4485AD1E4BE9615AF79CBE69444F703020B6879F296147009920DBB84B8473604871E83C5DFABD0B9C53003ADBE578D16EB179D65EA8426727DC036F9F92F3C954D44A4B80AFA0D0EB8398D5EC2AD56CAFE197092E98716014A1F5CDC856073EC187CB2CA7981EA14A1AED25720377BDB7F0C1DCC1ACD0C216B1675456B5393C2B29196CE5650A6900A6437C418EAFB830CB87FB1202162179C95DB5B839279190CFE76A39645346C2B5DF36E66030CEC27DC7374435CB99AAFF3B3CEE984E451564D3D2AB12AFA3189F183F1FECF335674D8C406B7A0B4A11DF5C777A2FAB86C95592E934F16AD436B0E1A15F2C10BE6933B37C179F06457F441F11AACA8C596EFCF1832C243A84A038CE908E91B1D68702B15C3D2DE3AD4905B506754E963D825600B228C7634B893F84F3B6D9CD892924F4439904EB4EA3A511AB654EB8CA8A273F61E2E9D6F5FA0C603D8C1C075983C37470A215A4640375021C5B5586339F92FEBD665D5FD55BC642F72CF3469394F946FB60922461B2A4386BC447FA235791DE9107FE20CF813A23F93A69E528DFEC5198A5F28D8285AFE0C528C97A4999E05C79EA9DC8C27ACA1B7D1C544AD7BBE6B47FD17B2BE2AC6396C6DBC78F91B4D563E0C2F4DFEF524DD01AF8146F18193CBF52FB0600550DAA1ACECDC27137526CF87F6AC936642965FDFB5B00EB7B8FDC35E42056FA26335CFF0D53D194B2E0007"

echo "  üë• PLAYERS..."
gh secret set PLAYERS --body '[7738147772,8631412913,9005903775,8419659295,2616521101]'

# AWS S3 / Magalu Cloud
echo "  ‚òÅÔ∏è  S3_BUCKET..."
gh secret set S3_BUCKET --body "bucket-tgferr-monitor"

echo "  üåê S3_ENDPOINT..."
gh secret set S3_ENDPOINT --body "https://br-se1.magaluobjects.com"

echo "  üîë S3_KEY..."
gh secret set S3_KEY --body "9c389761-baed-4495-b5ab-ce287e3fbcb4"

echo "  üîê S3_SECRET..."
gh secret set S3_SECRET --body "fec244d0-dfd1-46fe-9123-c574f2f576e1"

echo "  üåç S3_REGION..."
gh secret set S3_REGION --body "br-se1"

# Email
echo "  üìß EMAIL_USER..."
gh secret set EMAIL_USER --body "tiagomoz1988@gmail.com"

echo "  üîí EMAIL_PASS..."
gh secret set EMAIL_PASS --body "juudiidzyqbcfvtz"

echo "  üì® EMAIL_TO..."
gh secret set EMAIL_TO --body "tiagomoz1988@gmail.com"

# Timezone
echo "  üïê TZ_OFFSET_MINUTES..."
gh secret set TZ_OFFSET_MINUTES --body "-180"

echo ""
echo "‚úÖ Todos os secrets foram configurados com sucesso!"
echo ""
echo "üìã Verificando secrets criados..."
gh secret list

echo ""
echo "üöÄ Pronto! O GitHub Actions deve funcionar na pr√≥xima execu√ß√£o."
echo "‚è∞ O workflow roda a cada 5 minutos automaticamente."
echo ""
echo "üîç Para monitorar:"
echo "   üìä GitHub Actions: https://github.com/tgferrmonitor/monitor/actions"
echo "   üåê Interface Web: https://bucket-tgferr-monitor.br-se1.magaluobjects.com/"
echo "   üìÅ Arquivos S3: https://bucket-tgferr-monitor.br-se1.magaluobjects.com/080925.json"
